/**
 * @file js template
 * @author xucaiyu
 * @email 569455187@qq.com
 * @version 4.0
 * @date 2015-10-09
 * @license MIT License 
 */
!function(){function _logical_(e){return e}var escapeHash={"<":"&lt;",">":"&gt;","&":"&amp;",'"':"&quot;","'":"&#x27;","/":"&#x2f;"},_cache={},escapeFn=function(e){return escapeHash[e]},_escape_=function(e){return"string"!=typeof e?e:e.replace(/[&<>"'/]/gim,escapeFn)},isArray=Array.isArray||function(e){return"[object Array]"==={}.toString.call(e)},_each_=function(e,n,t,r){var a,o;if(isArray(e))for(a=n,o=t;o>a;a++)r.call(e,e[a],a,e);else for(a in e)r.call(e,e[a],a)},count=function(e){var n=typeof e;if("string"===n)return e.length;if("object"===n){var t=0;for(var r in e)t++;return t}return!1},fasTpl=function(e,n){if("string"!=typeof e)throw"Template not found";var t=fasTpl._parse.call(fasTpl,e);return void 0===n?t:t.render(n)},tools={_escape_:_escape_,_each_:_each_,_logical_:_logical_,count:count};fasTpl.tools=function(e,n){if("object"==typeof e)for(var t in e)tools[t]=e[t];else tools[e]=n},fasTpl.getTools=function(){return tools},fasTpl.tags={langOpen:"{{",langClose:"}}",varOpen:"\\${",varClose:"}",commentOpen:"{!--",commentClose:"--}"},fasTpl.version="3.0",fasTpl.uid="1",fasTpl.statement={"var":function(e){return"var "+e+";\r\n"},"if":function(e){return"if("+e+"){\r\n"},"else if":function(e){return"}else if("+e+"){\r\n"},"else":function(e){return"}else{\r\n"},"/if":function(e){return"}\r\n"},"for":function(e){var n,t,r="",a=e.replace(/\s/g,""),o=a.split("("),l=o[0],s=o[1]?o[1]:"";if(!e)throw"{{for}}: is not arguments";return""===s?r="_each_("+l+",0,"+l+".length,function(v, i){":""!==s?(n=s.split(")")[0].split(","),t=/\d+/.test(n[0])||/\d+/.test(n[1]),r=t?"_each_([],"+n+",function(data,"+(l?l:"i")+"){":"_each_("+l+",0,"+l+".length,function("+n+"){"):r="for"+a,"\r\n"+r+"\r\n"},"/for":function(e){return"\r\n});\r\n"},log:function(e){return"console.log("+e+");\r\n"}},fasTpl._compile=function(e){function n(e){var n;e&&!g[e]&&(n="_data."+e,_+=e+"="+n+",\r\n",g[e]=!0)}var t,r="\\s*(\\/?\\w+(?:\\s*if)?)\\s*([^"+fasTpl.tags.langClose+"]*)",a=fasTpl.tags.langOpen+"literal"+fasTpl.tags.langClose+"([\\s\\S]*)"+fasTpl.tags.langOpen+"/literal"+fasTpl.tags.langClose,o=fasTpl.tags.langOpen+r+fasTpl.tags.langClose,l=fasTpl.tags.varOpen+"([=\\s]?)([^\\|]+?)\\s*(?:(\\|+)([\\s\\S]+?))?"+fasTpl.tags.varClose,s=fasTpl.tags.commentOpen+"[\\s\\S]*"+fasTpl.tags.commentClose,i=new RegExp(a,"igm"),c=new RegExp(o,"igm"),f=new RegExp(l,"igm"),p=new RegExp(s,"igm"),_="var _tools_=_tools,\r\n_escape_=_tools_._escape_,\r\n_each_=_tools_._each_,\r\n_logical_=_tools_._logical_,\r\n",u="",g={};return t=e.replace(/[\r\t\n]/g,"").replace(p,"").replace(i,function(e,n){var t="_literal_"+fasTpl.uid++;return _+=t+"='"+n+"',","';_str+="+t+"+'"}).replace(c,function(e,n,t){var r=fasTpl.statement[n];if(!r)throw"Unknown template tag: "+n;return"'; "+r(t)+"_str+='"}).replace(f,function(e,t,r,a,o){if(a&&"|"!==a)-1===r.indexOf(".")&&n(r),r="_logical_("+r+a+o+")";else if(o){var l=o.split(":"),s=l[0].replace(/\s/g,""),i=l[1]||void 0;if(!tools[s])throw"Unknown template method: "+s;r="_tools_."+s+"("+r+","+i+")"}return"="!==t&&(r="_escape_("+r+")"),"'+"+r+"+'"}),u="_str = '';\r\n_str+='"+t+"';return new String(_str);",function(e){var n,t="";return tools._each_(e,0,0,function(e,n){t+=n+"=_data."+n+",\r\n"}),n=_+t+u,n.replace(/\_str\+\=\'\'\;/g,""),n}},fasTpl._parse=function(tpl){function render(){this._tpl=viewFn,this.render=function(data){var code;try{return code=this._tpl(data),new Function("_data, _tools",code)(data,tools).replace(/(^\s*)|(\s*$)/g,"")}catch(e){eval(code)}}}var viewFn;return _cache[tpl]?viewFn=_cache[tpl]:(viewFn=this._compile(tpl),_cache[tpl]=viewFn),new render},"function"==typeof define?define(function(){return fasTpl}):"undefined"!=typeof exports?module.exports=fasTpl:window.fasTpl=fasTpl}();
//# sourceMappingURL=fastpl.min.js.map
